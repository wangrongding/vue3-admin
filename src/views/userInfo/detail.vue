<script setup lang="ts">
import { ref, reactive } from "vue";
const state = reactive({
  formParams: {
    data: { birthday: "", avatar: "" }, // Ë°®ÂçïÊï∞ÊçÆÂØπË±°
    formList: {
      avatar: {
        type: "customItem",
        name: "avatar",
        label: "",
        style: "width:100%;text-align:center;",
      },
      role: {
        type: "text",
        label: "ËßíËâ≤",
        style: "width:45%",
      },
      nickName: {
        type: "text",
        label: "ÊòµÁß∞",
        placeholder: "ËØ∑ËæìÂÖ•ÁÆ°ÁêÜÂëòÂßìÂêç",
        style: "width:45%",
      },
      name: {
        type: "text",
        label: "ÂßìÂêç",
        placeholder: "ËØ∑ËæìÂÖ•ÁÆ°ÁêÜÂëòÂßìÂêç",
        style: "width:45%",
      },
      sex: {
        type: "select",
        label: "ÊÄßÂà´",
        placeholder: "ËØ∑ÈÄâÊã©ÊÄßÂà´",
        selectOptions: [
          { label: "Áî∑", value: 0 },
          { label: "Â•≥", value: 1 },
        ],
        style: "width:45%",
      },
      birthday: {
        type: "date-picker",
        label: "Âá∫ÁîüÊó•Êúü",
        placeholder: "ËØ∑ÈÄâÊã©Âá∫ÁîüÊó•Êúü",
        style: "width:45%",
        disabledDate: (date: any) => {
          return date.getTime() > Date.now();
        },
      },
    },
    rules: {
      sex: [{ required: true, message: "ËØ∑ËæìÂÖ•ÂßìÂêç", trigger: "blur" }],
    },
    inline: true,
    align: "center",
    labelWidth: "200px",
    submit: {
      submitText: "Êü•ËØ¢",
      submitFunction: () => {},
      reset: true,
    },
  },
  passwordForm: {
    data: { birthday: "" }, // Ë°®ÂçïÊï∞ÊçÆÂØπË±°
    formList: {
      phone: {
        type: "number",
        maxlength: 11,
        label: "ÂΩìÂâçÊâãÊú∫Âè∑Á†ÅÔºö",
        placeholder: "ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑Á†Å",
        style: "width:100%",
      },
      oldPassword: {
        type: "text",
        label: "ÂΩìÂâçÂØÜÁ†ÅÔºö",
        style: "width:100%",
      },
      newPassword: {
        type: "text",
        label: "Êñ∞ÂØÜÁ†ÅÔºö",
        style: "width:100%",
      },
    },
    rules: {
      phone: [{ required: true, message: "ËØ∑ËæìÂÖ•ÂßìÂêç", trigger: "blur" }],
      oldPassword: [{ required: true, message: "ËØ∑ËæìÂÖ•ÂßìÂêç", trigger: "blur" }],
      newPassword: [{ required: true, message: "ËØ∑ËæìÂÖ•ÂßìÂêç", trigger: "blur" }],
    },
    labelWidth: "200px",
    submit: {
      submitText: "Êü•ËØ¢",
      submitFunction: () => {},
      reset: false,
    },
  },
  phoneForm: {
    data: { birthday: "" }, // Ë°®ÂçïÊï∞ÊçÆÂØπË±°
    formList: {
      oldPhone: {
        type: "number",
        maxlength: 11,
        label: "ÂΩìÂâçÊâãÊú∫Âè∑Á†ÅÔºö",
        placeholder: "ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑Á†Å",
        style: "width:100%",
      },
      newPhone: {
        type: "number",
        maxlength: 11,
        label: "ÂΩìÂâçÊâãÊú∫Âè∑Á†ÅÔºö",
        placeholder: "ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑Á†Å",
        style: "width:100%",
      },
      code: {
        type: "number",
        maxlength: 11,
        label: "ÂΩìÂâçÊâãÊú∫Âè∑Á†ÅÔºö",
        placeholder: "ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑Á†Å",
        style: "width:100%",
      },
    },
    rules: {
      phone: [{ required: true, message: "ËØ∑ËæìÂÖ•ÂßìÂêç", trigger: "blur" }],
      oldPassword: [{ required: true, message: "ËØ∑ËæìÂÖ•ÂßìÂêç", trigger: "blur" }],
      newPassword: [{ required: true, message: "ËØ∑ËæìÂÖ•ÂßìÂêç", trigger: "blur" }],
    },
    labelWidth: "200px",
    submit: {
      submitText: "Êü•ËØ¢",
      submitFunction: () => {},
      reset: false,
    },
  },
});
const loading = ref("");

const tempAvatar = new URL("../../assets/image/logo.png", import.meta.url).href;
console.log("üöÄ / file: index.vue / line 70 / tempAvatar", tempAvatar);
//Êõ¥Êç¢Â§¥ÂÉè
const uploadFile = (file: any, fileList: any) => {
  console.log(file, fileList);
  let tempFile = new FormData();
  tempFile.append("file", file.raw);
  // uploadFile(tempFile).then((res) => {
  //   this.$set(this.formParams.data, "courseCover", res);
  // });
};
const showType = ref("userInfo");
//ÂàáÊç¢tab
const changeType = (a: any, b: any, c: any) => {
  showType.value = a;
  console.log(a, b, c);
};
</script>
<template>
  <div class="page-container">
    <div class="item-nav-bar">
      <el-menu :default-active="'1'" class="el-menu-demo" mode="horizontal" @select="changeType">
        <el-menu-item
          v-for="item in [
            { name: '‰ø°ÊÅØ', value: 'userInfo' },
            { name: 'ÂØÜÁ†Å', value: 'password' },
            { name: 'ÊâãÊú∫Âè∑', value: 'phone' },
          ]"
          style="height: 46px"
          :index="item.value"
        >
          {{ item.name }}
        </el-menu-item>
      </el-menu>
    </div>
    <Form
      v-show="showType == 'userInfo'"
      :form-params="state.formParams"
      style="width: 1300px; margin: 0 auto"
    >
      <template #avatar="{ itemForm }">
        <div slot="trigger">
          <img
            :src="state.formParams.data.avatar || tempAvatar"
            style="width: 100px; height: 100px"
            alt=""
          />
          <el-button
            slot="trigger"
            style="display: block; margin: 0 auto"
            size="small"
            type="text"
            :loading="loading == 'upload'"
          >
            ‰øÆÊîπÂ§¥ÂÉè
          </el-button>
        </div>
      </template>
    </Form>
    <Form
      v-show="showType == 'password'"
      :form-params="state.passwordForm"
      style="width: 500px; margin: 0 auto"
    />
    <Form
      v-show="showType == 'phone'"
      :form-params="state.phoneForm"
      style="width: 500px; margin: 0 auto"
    />
  </div>
</template>
<style lang="scss" scoped>
.page-container {
  background-color: white;
  border-radius: 20px;
  box-sizing: border-box;
  padding: 0 50px;
  .item-nav-bar {
    height: 50px;
    padding: 10px 0px 0;
    border-bottom: #c3c3c3;
  }
}
</style>
